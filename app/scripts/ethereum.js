Ethereum = function() {

    var _accounts = [];
    var _accounts_handlers = [];
    var accounts = function () {
        if (arguments.length == 0) {
            return _accounts;
        } else if (typeof(arguments[0]) === 'function') {
            _accounts_handlers.push(arguments[0]);
            arguments[0](_accounts);
        } else {
            var oldValue = _accounts;
            var newValue = arguments[0];
            _accounts = arguments[0];
            _accounts_handlers.forEach(function (handler) {
                handler(newValue, oldValue);
            });
        }
    };

    web3 = new Web3();
    var provider = new web3.providers.HttpProvider('http://localhost:8545');
    web3.setProvider(provider);

    var contractAddress = "0xd752cd3f065a66b7c7eb21e689b4c803cd9727f3";
    var contract = TruffleContract({
        "contract_name": "FacebookAccounts",
        "abi": [
            {
                "constant": false,
                "inputs": [],
                "name": "withdrawRefund",
                "outputs": [],
                "payable": false,
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "verificationPrice",
                "outputs": [
                    {
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "payable": false,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "withdrawOwnerBalance",
                "outputs": [],
                "payable": false,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_owner",
                        "type": "address"
                    }
                ],
                "name": "changeContractOwner",
                "outputs": [],
                "payable": false,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [],
                "name": "depositOwnerBalance",
                "outputs": [],
                "payable": true,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_account",
                        "type": "string"
                    }
                ],
                "name": "revokeAccountOwnership",
                "outputs": [],
                "payable": false,
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [
                    {
                        "name": "",
                        "type": "address"
                    }
                ],
                "name": "verifier",
                "outputs": [
                    {
                        "name": "",
                        "type": "bool"
                    }
                ],
                "payable": false,
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [
                    {
                        "name": "_account",
                        "type": "string"
                    },
                    {
                        "name": "_owner",
                        "type": "address"
                    }
                ],
                "name": "isAccountOwnedByAddress",
                "outputs": [
                    {
                        "name": "",
                        "type": "bool"
                    }
                ],
                "payable": false,
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "owner",
                "outputs": [
                    {
                        "name": "",
                        "type": "address"
                    }
                ],
                "payable": false,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_verifier",
                        "type": "address"
                    }
                ],
                "name": "addVerifier",
                "outputs": [],
                "payable": false,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_account",
                        "type": "string"
                    },
                    {
                        "name": "_claimant",
                        "type": "address"
                    }
                ],
                "name": "acknowledgeClaim",
                "outputs": [],
                "payable": false,
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [
                    {
                        "name": "",
                        "type": "address"
                    }
                ],
                "name": "refundableBalance",
                "outputs": [
                    {
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "payable": false,
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "ownerBalance",
                "outputs": [
                    {
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "payable": false,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_account",
                        "type": "string"
                    }
                ],
                "name": "claimAccount",
                "outputs": [],
                "payable": true,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_verifier",
                        "type": "address"
                    }
                ],
                "name": "removeVerifier",
                "outputs": [],
                "payable": false,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_account",
                        "type": "string"
                    },
                    {
                        "name": "_claimant",
                        "type": "address"
                    }
                ],
                "name": "refundClaim",
                "outputs": [],
                "payable": true,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_account",
                        "type": "string"
                    }
                ],
                "name": "askForRefund",
                "outputs": [],
                "payable": false,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_verificationPrice",
                        "type": "uint256"
                    }
                ],
                "name": "changeVerificationPrice",
                "outputs": [],
                "payable": false,
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_account",
                        "type": "string"
                    },
                    {
                        "name": "_claimant",
                        "type": "address"
                    }
                ],
                "name": "completeVerification",
                "outputs": [],
                "payable": false,
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "name": "_verificationPrice",
                        "type": "uint256"
                    }
                ],
                "payable": false,
                "type": "constructor"
            }
        ],
        "unlinked_binary": "0x6060604052341561000c57fe5b604051602080610f8b83398101604052515b60008054600160a060020a03191633600160a060020a031617905560058190555b505b610f3b806100506000396000f300606060405236156100eb5763ffffffff60e060020a600035041663110f887481146100ed57806321c77bf3146100ff5780633c69c657146101215780633ead67b51461013657806344616ed71461015457806369658ffb1461015e578063809f3bc4146101b6578063881896b1146101e65780638da5cb5b1461025b5780639000b3d614610287578063aab71424146102a5578063b03d36cd14610308578063bedcf00314610336578063c34a77bf14610358578063ca2dfd0a146103a8578063cd1de94f146103c6578063e9d27c8314610421578063ee77ee4914610479578063f67497501461048e575bfe5b34156100f557fe5b6100fd6104f1565b005b341561010757fe5b61010f610559565b60408051918252519081900360200190f35b341561012957fe5b6100fd60043561055f565b005b341561013e57fe5b6100fd600160a060020a03600435166105c1565b005b6100fd6105f9565b005b341561016657fe5b6100fd600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284375094965061061d95505050505050565b005b34156101be57fe5b6101d2600160a060020a03600435166106cf565b604080519115158252519081900360200190f35b34156101ee57fe5b6101d2600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284375094965050509235600160a060020a031692506106e4915050565b604080519115158252519081900360200190f35b341561026357fe5b61026b61076f565b60408051600160a060020a039092168252519081900360200190f35b341561028f57fe5b6100fd600160a060020a036004351661077e565b005b34156102ad57fe5b6100fd600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284375094965050509235600160a060020a031692506107c1915050565b005b341561031057fe5b61010f600160a060020a03600435166108b5565b60408051918252519081900360200190f35b341561033e57fe5b61010f6108c7565b60408051918252519081900360200190f35b6100fd600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437509496506108cd95505050505050565b005b34156103b057fe5b6100fd600160a060020a0360043516610a6e565b005b6100fd600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284375094965050509235600160a060020a03169250610aab915050565b005b341561042957fe5b6100fd600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843750949650610c6495505050505050565b005b341561048157fe5b6100fd600435610d4d565b005b341561049657fe5b6100fd600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284375094965050509235600160a060020a03169250610d6f915050565b005b600160a060020a03331660009081526004602052604081205481901161051357fe5b50600160a060020a033316600081815260046020526040808220805490839055905190929183156108fc02918491818181858888f19350505050151561055557fe5b5b50565b60055481565b60005433600160a060020a0390811691161461057757fe5b60035481111561058357fe5b60038054829003905560008054604051600160a060020a039091169183156108fc02918491818181858888f19350505050151561055557fe5b5b5b50565b60005433600160a060020a039081169116146105d957fe5b60008054600160a060020a031916600160a060020a0383161790555b5b50565b60005433600160a060020a0390811691161461061157fe5b60038054340190555b5b565b60006002826040518082805190602001908083835b602083106106515780518252601f199092019160209182019101610632565b51815160209384036101000a60001901801990921691161790529201948552506040805194859003820190942033600160a060020a031660009081526001820190925293902054929350505060ff1615156106a857fe5b600160a060020a03331660009081526001820160205260409020805460ff191690555b5050565b60016020526000908152604090205460ff1681565b60006002836040518082805190602001908083835b602083106107185780518252601f1990920191602091820191016106f9565b51815160209384036101000a600019018019909216911617905292019485525060408051948590038201909420600160a060020a03871660009081526001909101909152929092205460ff16925050505b92915050565b600054600160a060020a031681565b60005433600160a060020a0390811691161461079657fe5b600160a060020a0381166000908152600160208190526040909120805460ff191690911790555b5b50565b6000805433600160a060020a03908116911614806107f75750600160a060020a03331660009081526001602052604090205460ff165b15156107ff57fe5b6002836040518082805190602001908083835b602083106108315780518252601f199092019160209182019101610812565b51815160209384036101000a600019018019909216911617905292019485525060408051948590038201909420600160a060020a0387166000908152915292909220805490935060ff1615159150610887905057fe5b600381015460ff16151561089757fe5b6003808201805460ff19169055600282015481540190555b5b505050565b60046020526000908152604090205481565b60035481565b600060006002836040518082805190602001908083835b602083106109035780518252601f1990920191602091820191016108e4565b51815160209384036101000a60001901801990921691161790529201948552506040805194859003820190942033600160a060020a031660009081529181905293902080549395509350505060ff161561095957fe5b600160a060020a033316600090815260018301602052604090205460ff161561097e57fe5b600554341461098957fe5b6080604051908101604052806001151581526020014281526020016005548152602001600115158152506002846040518082805190602001908083835b602083106109e55780518252601f1990920191602091820191016109c6565b51815160001960209485036101000a0190811690199190911617905292019485525060408051948590038201909420600160a060020a03331660009081529082528490208551815490151560ff1991821617825591860151600182015593850151600285015560609094015160039093018054931515939094169290921790925550505b505050565b60005433600160a060020a03908116911614610a8657fe5b600160a060020a0381166000908152600160205260409020805460ff191690555b5b50565b6000805433600160a060020a0390811691161480610ae15750600160a060020a03331660009081526001602052604090205460ff165b1515610ae957fe5b6002836040518082805190602001908083835b60208310610b1b5780518252601f199092019160209182019101610afc565b51815160209384036101000a600019018019909216911617905292019485525060408051948590038201909420600160a060020a0387166000908152915292909220805490935060ff1615159150610b71905057fe5b600381015460ff161515610bad57600281015460035410610ba057600281015460038054919091039055610bad565b60028101543414610bad57fe5b5b5b600280820154600160a060020a0384166000908152600460209081526040808320805490940190935591518651919392879282918401908083835b60208310610c095780518252601f199092019160209182019101610bea565b51815160209384036101000a600019018019909216911617905292019485525060408051948590038201909420600160a060020a0388166000908152915292909220805460ff19169315159390931790925550505b5b505050565b60006002826040518082805190602001908083835b60208310610c985780518252601f199092019160209182019101610c79565b51815160209384036101000a60001901801990921691161790529201948552506040805194859003820190942033600160a060020a03166000908152915292909220805490935060ff1615159150610cee905057fe5b600381015460ff161515610cfe57fe5b610d088233610e7d565b1515610d1057fe5b805460ff191681556002810154604051600160a060020a0333169180156108fc02916000818181858888f1935050505015156106cb57fe5b5b5050565b60005433600160a060020a03908116911614610d6557fe5b60058190555b5b50565b60008054819033600160a060020a0390811691161480610da75750600160a060020a03331660009081526001602052604090205460ff165b1515610daf57fe5b6002846040518082805190602001908083835b60208310610de15780518252601f199092019160209182019101610dc2565b51815160209384036101000a600019018019909216911617905292019485525060408051948590038201909420600160a060020a03881660009081529181905293902080549395509350505060ff161515610e3857fe5b600381015460ff1615610e4757fe5b805460ff199081168255600160a060020a03841660009081526001848101602052604090912080549092161790555b5b50505050565b600060006002846040518082805190602001908083835b60208310610eb35780518252601f199092019160209182019101610e94565b51815160209384036101000a600019018019909216911617905292019485525060408051948590038201909420600160a060020a03881660009081529152929092206001810154620151800142119450925050505b50929150505600a165627a7a7230582077cc210826dd0354cf9e34159e6c37541e4017a2847a17f57c2c8696c7307b2e0029",
        "networks": {
            "1499374274326": {
                "events": {},
                "links": {},
                "address": "0xaa2401c7318a8505c5f3bd4ece5277f17d24a47f",
                "updated_at": 1499377015183
            }
        },
        "schema_version": "0.0.5",
        "updated_at": 1499377015183
    });
    contract.setProvider(provider);

    var asyncMakeClaim = function(ethAccount, fbAccount) {
        return contract.at(contractAddress).then(function(instance) {
            return instance.claimAccount(fbAccount, {from: ethAccount, value: 9999, gas: 3500000});
        })
    };

    accounts(web3.eth.accounts);

    return {
        accounts: accounts,
        asyncMakeClaim: asyncMakeClaim
    };

}();